#!/usr/bin/env python
# -*- coding: utf-8 -*- 
# 05-06-2024
# alex
# solar.py

import numpy as np

def iniSS(quins):
    ## dades a 28/06/1969 00:00
    ## Exemples
    ## Júpiter - Plutó
    ##   quins = [1, 0, 0, 0, 0, 1, 1, 1, 1, 1]
    ## Mercuri - Mart (tam = 5)
    ##   quins = [1, 1, 1, 1, 1]
    ## Mercuri - Plutó (tam = 10)
    ##   quins = [1]*10
    ## Mercuri - Plutó + satèl·lits + planetes nans (tam = 18)
    ##   quins = [1]*18
    tam = 18
    q, v = np.zeros((tam, 3)), np.zeros((tam, 3))
    m = [0.0]*tam
    # Sol
    ic = 0
    m[ic] = 0.295912208285591100E-03
    q[ic][0], q[ic][1], q[ic][2] = -5.730606324378153E-03, -4.910557082772070E-03, 1.795094577858112E-04
    v[ic][0], v[ic][1], v[ic][2] = 7.160788611314778E-06, -3.666546272590425E-06, -1.176972196034231E-07
    ##  Ander
    m[ic] = 0.0002959139769522548
    q[ic][0], q[ic][1], q[ic][2] = 0.00450437331536355, 0.0007629594757318989, 0.0002641472510286893
    v[ic][0], v[ic][1], v[ic][2] = -2.685891875052036E-7, 5.22535355440402E-6, 2.2489501172420475E-6
    4.501771046200178E-03,  7.667597654825399E-04,  2.662206318863734E-04, -3.517482063742068E-07,  5.177625639825057E-06,  2.229090837927562E-06
    ## Mercuri
    ic += 1
    m[ic] = 0.491248045036476000E-10
    q[ic][0] = -3.930336148500469E-01
    q[ic][1] = -1.666347517169735E-01
    q[ic][2] = 2.248723485902817E-02
    v[ic][0] = 5.031590985068973E-03
    v[ic][1] = -2.474711985703500E-02
    v[ic][2] = -2.483041558403887E-03
    ## Venus 
    ic += 1
    m[ic] = 0.724345233264412000E-09
    q[ic][0] = 4.476881591494200E-01
    q[ic][1] = 5.573055222132830E-01
    q[ic][2] = -1.826185079464067E-02
    v[ic][0] = -1.579911349143828E-02
    v[ic][1] = 1.260639609552168E-02
    v[ic][2] = 1.085100185838057E-03
    ## La Terra
    ic += 1
    m[ic] = 0.888769244512563400E-09
    q[ic][0] = -1.844140472974828E-01
    q[ic][1] = 9.620722382946830E-01
    q[ic][2] = 1.284152186349546E-04
    v[ic][0] = -1.719757779305811E-02
    v[ic][1] = -3.197199735579798E-03
    v[ic][2] = -1.122400455364092E-07
    ## Mart
    ic += 1
    m[ic] = 0.954954869555077000E-10
    q[ic][0] = -5.274164728925163E-01
    q[ic][1] = 1.520324019719684E+00
    q[ic][2] = 4.493510749539490E-02
    v[ic][0] = -1.270467411479119E-02
    v[ic][1] = -3.342506132667855E-03
    v[ic][2] = 2.416611203580803E-04
    ## Júpiter
    ic += 1
    m[ic] = 0.282534584083387000E-06
    q[ic][0], q[ic][1], q[ic][2] = 1.050302939252324E+00, 4.966541604941111E+00, -4.409855432676144E-02
    v[ic][0], v[ic][1], v[ic][2] = -7.469111612367896E-03, 1.920799528808175E-03, 1.591398359241618E-04
    
    ##  Ander
    q[ic][0], q[ic][1], q[ic][2] = -5.379706767941303, -0.8304813277550269, -0.22482887488926878
    v[ic][0], v[ic][1], v[ic][2] = 0.0010920125980612367, -0.00651811661063409, -0.002820782762088689
    ## Saturn
    ic += 1
    m[ic] = 0.845970607324503000E-07
    q[ic][0], q[ic][1], q[ic][2] = 9.455336665176439E+00, -1.769525277925947E+00, -3.456968909591847E-01
    v[ic][0], v[ic][1], v[ic][2] = 7.165415690664376E-04, 5.471430990255198E-03, -1.233522942159990E-04
    ##  Ander
    q[ic][0], q[ic][1], q[ic][2] = 7.894390683522165, 4.596478053979644, 1.5586958423691966
    v[ic][0], v[ic][1], v[ic][2] = -0.0032175565126770166, 0.00433581034391992, 0.001928646317070145
    ## Urà
    ic += 1
    m[ic] = 0.129202482578296000E-07
    q[ic][0], q[ic][1], q[ic][2] = 1.109789820880128E+01, 1.608957335509925E+01, -8.401882312746477E-02
    v[ic][0], v[ic][1], v[ic][2] = -3.266567450208665E-03, 2.049861782622937E-03, 4.996819331008718E-05
    ##  Ander
    q[ic][0], q[ic][1], q[ic][2] = -18.265402253259726, -1.161955419867499, -0.2501060581840414
    v[ic][0], v[ic][1], v[ic][2] = 0.00022119039483951383, -0.00376247500593555, -0.00165101502721996
    ## Neptú
    ic += 1
    m[ic] = 0.152435734788511000E-07
    q[ic][0], q[ic][1], q[ic][2] = 2.987419674943718E+01, -6.390985521271113E-01, -6.753202855837556E-01
    v[ic][0], v[ic][1], v[ic][2] = 4.657674111212642E-05, 3.156723229456242E-03, -6.648766294387875E-05
    ##  Ander
    q[ic][0], q[ic][1], q[ic][2] = -16.055035779620734, -23.94219156104634, -9.400157969265099
    v[ic][0], v[ic][1], v[ic][2] = 0.0026427698518039547, -0.0014983125483676832, -0.0006790419605929234
    ## Plutó
    ic += 1
    m[ic] = 0.217844105197418000E-11
    q[ic][0], q[ic][1], q[ic][2] = 1.822308572034037E+01, -3.001292349610227E+01, -2.059636276371235E+00
    v[ic][0], v[ic][1], v[ic][2] = 2.766138643858243E-03, 9.420599387438552E-04, -8.881992368015251E-04
    ##  Ander
    q[ic][0], q[ic][1], q[ic][2] = -30.483313766571207, -0.872405558032679, 8.911576172036847
    v[ic][0], v[ic][1], v[ic][2] = 0.00032220737732167995, -0.003143576391472034, -0.001077949759387323
    
    tam_sel = quins.count(1)
    q_sel, v_sel = np.zeros((tam_sel, 3)), np.zeros((tam_sel, 3))
    m_sel = [0.0]*tam_sel
    j = 0
    for i in range(len(quins)):
        if quins[i] != 0:
            m_sel[j] = m[i]
            q_sel[j][0], q_sel[j][1], q_sel[j][2] = q[i][0], q[i][1], q[i][2]
            v_sel[j][0], v_sel[j][1], v_sel[j][2] = v[i][0], v[i][1], v[i][2]
            j += 1
    z = np.concatenate((q_sel.reshape(tam_sel*3), v_sel.reshape(tam_sel*3))).astype("float128")
    z = list(map(str, z))
    mas = expand_masses(m_sel)
    return z, mas

def expand_masses(vec):
    np = len(vec)
    Gm, GM, Gmb, nu, mu = list(vec).copy(), [0.0]*np, [0.0]*np, [0.0]*np, [0.0]*np
    GM[0] = Gm[0]
    for i in range(np):
        GM[i] = GM[i - 1] + Gm[i]
    Gmb[0] = GM[np - 1]
    nu[0] = Gm[0]/GM[0]
    mu[0] = 0.0
    for i in range(1, np):
        Gmb[i] = GM[i - 1]*Gm[i]/GM[i]
        nu[i] = Gm[i]/GM[i]
        mu[i] = Gm[0]*Gm[i]/Gmb[i]
    return list(map(str, Gm + GM + Gmb + nu + mu))
